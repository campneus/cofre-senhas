<!-- views/credential-form.ejs -->
<div class="page-header">
  <div>
    <h1 class="page-title"><%= credential.id ? 'Editar' : 'Nova' %> Senha</h1>
    <p class="page-subtitle">
      <%= credential.id ? 'Atualize as informações de acesso' : 'Cadastre uma nova credencial' %>
    </p>
  </div>
</div>

<div class="card">
  <div class="card-body">
    <form 
      action="<%= credential.id ? `/credentials/${credential.id}?_method=PUT` : '/credentials' %>" 
      method="POST"
    >
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
        <div class="form-group">
          <label for="system_name" class="form-label">Nome do Sistema *</label>
          <input 
            type="text" 
            id="system_name" 
            name="system_name" 
            class="form-control" 
            value="<%= credential.system_name || '' %>" 
            required
          >
        </div>

        <div class="form-group">
          <label for="category_id" class="form-label">Categoria *</label>
          <select id="category_id" name="category_id" class="form-select" required>
            <option value="">Selecione uma categoria</option>
            <% categories.forEach(category => { %>
              <option 
                value="<%= category.id %>" 
                <%= credential.category_id == category.id ? 'selected' : '' %>
              >
                <%= category.name %>
              </option>
            <% }); %>
          </select>
        </div>

        <div class="form-group">
          <label for="location_id" class="form-label">Localidade</label>
          <select id="location_id" name="location_id" class="form-select">
            <option value="">Selecione uma localidade</option>
            <% locations.forEach(location => { %>
              <option 
                value="<%= location.id %>" 
                <%= credential.location_id == location.id ? 'selected' : '' %>
              >
                <%= location.name %>
              </option>
            <% }); %>
          </select>
        </div>

        <div class="form-group">
          <label for="username" class="form-label">Usuário *</label>
          <input 
            type="text" 
            id="username" 
            name="username" 
            class="form-control" 
            value="<%= credential.username || '' %>" 
            required
          >
        </div>

        <div class="form-group">
          <label for="password" class="form-label">Senha *</label>
          <div class="password-field" style="display: flex;">
            <input 
              type="password" 
              id="password" 
              name="password" 
              class="form-control" 
              value="<%= credential.password || '' %>" 
              required
              style="flex: 1;"
            >
            <span class="password-toggle" style="position: absolute; right: 50px; top: 50%; transform: translateY(-50%);">
              <i class="fas fa-eye"></i>
            </span>
            <button type="button" id="generate-password" class="btn btn-info" style="margin-left: 10px;">
              <i class="fas fa-dice"></i> Gerar
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="url" class="form-label">URL</label>
          <input 
            type="url" 
            id="url" 
            name="url" 
            class="form-control" 
            value="<%= credential.url || '' %>"
          >
        </div>
      </div>

      <div class="form-group">
        <label for="notes" class="form-label">Observações</label>
        <textarea 
          id="notes" 
          name="notes" 
          class="form-control" 
          rows="4"
        ><%= credential.notes || '' %></textarea>
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-save"></i> Salvar
        </button>
        <a href="/credentials" class="btn btn-danger">
          <i class="fas fa-times"></i> Cancelar
        </a>
      </div>
    </form>
  </div>
</div>